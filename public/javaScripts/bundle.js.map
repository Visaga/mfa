{"version":3,"sources":["webpack://mfa/./public/javaScripts/getAndRender.js"],"names":["document","addEventListener","querySelector","rightBarBlocks","rightBarStickyBlock","lazyLoadingBlock","category","textContent","getBlogs","then","data","renderBlogs","catch","err","console","log","finally","advert","createElement","innerHTML","style","cssText","append","position","top","renderStickyBlock","blogSize","inProgress","startFrom","parrent","rel","currentBlogTitle","getElementById","innerText","forEach","blog","ind","title","blogPreview","size","classList","add","ifUpdatedDate","modifiedDate","length","slice","createdDate","urlExtention","replace","_id","prevImg","quantity","fetch","respond","json","res","window","body","offsetHeight","pageYOffset","reverse","linkList","async","sameCategoryBlogs","filter","i","link","renderSimilarContentLinks"],"mappings":"AAAAA,SAASC,iBAAiB,oBAAoB,KAE1BD,SAASE,cAAc,iBAA3C,MACMC,EAAiBH,SAASE,cAAc,mBACxCE,EAAsBJ,SAASE,cAAc,yBAC7CG,EAAmBL,SAASE,cAAc,qBAI1CI,EAAWN,SAASE,cAAc,aAAaK,YAKpDC,EAAS,EAAE,EAAEF,GACZG,MAAKC,GAAQC,EAAYR,EAAgBO,EAAM,oBAC/CE,OAAMC,GAAOC,QAAQC,IAAI,yCAA2CF,KACpEG,SAAQ,MA0FT,WACA,MAAMC,EAASjB,SAASkB,cAAc,OAEtCD,EAAOE,UAAY,UAInBF,EAAOG,MAAMC,QAAS,oGAOtBjB,EAAoBkB,OAAOL,GAC3Bb,EAAoBgB,MAAMG,SAAW,SACrCnB,EAAoBgB,MAAMI,IAAM,OA1GfC,MASjB,MACMC,EAAW,CAAC,WAAY,WAAW,YACzC,IAAIC,GAAa,EACbC,EAAY,EA+BhB,SAASjB,EAAYkB,EAASnB,EAAKoB,EAAM,IAAKJ,EAAW,CAAC,cACzD,MAAMK,EAAmB/B,SAASgC,eAAe,SAASC,UAE1DvB,EAAKwB,SAAQ,CAACC,EAAMC,KACnB,GAAID,EAAKE,OAASN,EAAiB,CACnC,MAAMO,EAActC,SAASkB,cAAc,OAE3CQ,EAASQ,SAAQK,GAAQD,EAAYE,UAAUC,IAAIF,KAEnD,MACMG,EAAgBP,EAAKQ,aAAaC,OAAS,EAAIT,EAAKQ,aAAaE,MAAM,EAAE,IAAKV,EAAKW,YAAYD,MAAM,EAAE,IAE7GP,EAAYnB,UAAY,gBACjBW,qBAAwBK,EAAKY,aAAaC,QAAQ,KAAM,QAAUb,EAAKc,2IAExDd,EAAKe,QAAQF,QAAQ,UAAW,yDAA2Db,EAAKE,sLAGpEF,EAAK7B,2EACXoC,oFAGXP,EAAKE,oEAKtCR,EAAQP,OAAOgB,OAQjB,SAAS9B,EAASoB,EAAY,EAAGuB,EAAW,EAAG7C,EAAW,OAEzD,OAAO8C,MAAM,iBAAkBxB,KAAetB,KAAc6C,KAC3D1C,MAAK4C,GAAWA,EAAQC,SACxB7C,MAAK8C,GAAOA,IACZ3C,OAAMC,GAAOC,QAAQC,IAAI,kBAAoBF,KAnE/C2C,OAAOvD,iBAAiB,UAAU,KAC3BD,SAASyD,KAAKC,aAAeF,OAAOG,aAAgB,MAAsB,GAAdhC,IACjEA,GAAa,EAEbnB,EAASoB,EAXa,IAYrBnB,MAAKC,IACDA,EAAKkC,OAAS,IACjBlC,EAAOA,EAAKkD,UACZjD,EAAYN,EAAkBK,EAAM,iBAAiBgB,IAE/ChB,KAEPD,MAAMC,IAnBe,IAoBjBA,EAAKkC,QACRhB,GAAalB,EAAKkC,OAClBjB,GAAa,GACNb,QAAQC,IAAI,6CAEpBH,OAAMC,GAAOC,QAAQC,IAAI,8CAAgDF,SAkF5E,MAAMgD,EAAW7D,SAASE,cAAc,qBAGxCM,EAASoB,EAAY,EAAGuB,SAAW,GAAI,OACtC1C,MAAKC,GAINoD,eAA0CpD,GACzC,MAAMqD,QAA0BrD,EAAKsD,QAAQ7B,GAAQA,EAAK7B,UAAYA,IAEnE,IAAI,IAAI2D,EAAI,EAAGA,EAAI,EAAGA,IAAI,CAE5B,MAAMC,EAAOlE,SAASkB,cAAc,MACpCgD,EAAK/C,UAAY,aAAa4C,EAAkBE,GAAGlB,kBAAmBgB,EAAkBE,GAAG5B,aAE3FwB,EAASvC,OAAO4C,IAZJC,CAA0BzD","file":"bundle.js","sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n\t\nconst mainContent = document.querySelector(\"#main-content\");\t\nconst rightBarBlocks = document.querySelector(\"#rightBarBlocks\");\nconst rightBarStickyBlock = document.querySelector(\"#rightBar-stickyBlock\");\t\nconst lazyLoadingBlock = document.querySelector(\"#lazyLoadingBlock\");\n\n\n\t\nconst category = document.querySelector(\"#category\").textContent;\n\t\n\t\n\t//Render some blocks to Right Bar\n\t\n\tgetBlogs(0,5,category)\n\t.then(data => renderBlogs(rightBarBlocks, data, \"rel='nofollow'\"))\n\t.catch(err => console.log(\"Problem to load right bar content.. : \" + err))\n\t.finally(() => { renderStickyBlock() });\n\t\n\t\n\n\t\n\t\n\t// RENDER ON SCROLL  TO BOTTOM BLOCK \n\t\n\t//------settings-----\n\tconst blogsPerRequest = 10;\n\tconst blogSize = [\"col-sm-6\", \"col-lg-4\",\"col-xl-3\"];\n\tlet inProgress = false;\n\tlet startFrom = 0;\n\t//-------------------\n\t\n\t\n\twindow.addEventListener(\"scroll\", () => {\n\t\tif ( (document.body.offsetHeight - window.pageYOffset) <= 1200 && inProgress == false){\n\t\t\tinProgress = true;\n\t\t\t\n\t\t\tgetBlogs(startFrom, blogsPerRequest)\n\t\t\t.then(data => {\n\t\t\t\tif (data.length > 0){\n\t\t\t\t\tdata = data.reverse();\n\t\t\t\t\trenderBlogs(lazyLoadingBlock, data, \"rel='nofollow'\",blogSize);\n\t\t\t\t} \n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.then((data) => {\n\t\t\t\tif (data.length == blogsPerRequest){\n\t\t\t\t\tstartFrom += data.length;\n\t\t\t\t\tinProgress = false;\n\t\t\t\t} else {console.log(\"No more data available for the request\")}\n\t\t\t})\n\t\t\t.catch(err => console.log(\"SOMETHING WHENT WRONG!!! TRY AGAIN LATER:  \" + err));\n\t\t}\n\t});\n\t\n\t\n\t//===========FUNCTIONS============================\n\t\n\t//RENDER RECEIVED BLOGS\n\t\n\tfunction renderBlogs(parrent, data,rel = \" \", blogSize = [\"col-sm-12\"], ){\n\t\tconst currentBlogTitle = document.getElementById(\"title\").innerText;\n\t\t\n\t\tdata.forEach((blog, ind) => {\n\t\t\tif (blog.title != currentBlogTitle){\n\t\t\tconst blogPreview = document.createElement(\"div\");\n\t\t\t       \n\t\t\tblogSize.forEach(size => blogPreview.classList.add(size));\n\t\t\t\n\t\t\tconst relAt = `rel=\"${ rel }\"`\n\t\t\tconst ifUpdatedDate = blog.modifiedDate.length > 1 ? blog.modifiedDate.slice(0,10): blog.createdDate.slice(0,10);\n\t\t\t\t\t\t\n\t\t\tblogPreview.innerHTML = `\n\t\t\t\t<a ${ rel } href=\"/articles/${blog.urlExtention.replace(/ /g, \"-\") }/${ blog._id }\" class=\"text-decoration-none col text-dark\">\t\t \n\t\t\t\t\t<div class=\"card mb-3 h-100  border-0 \" >\n\t\t\t\t\t\t      <img src=\"${ blog.prevImg.replace(\"/upload\", \"/upload/w_600\") }\" class=\"card-img-top rounded-0\" alt=\"${ blog.title }\">\n\t\t\t\t\t\t        <div class=\"card-body p-0 pt-2\">\n                                <div class=\"post-meta\">\n\t\t\t\t\t\t\t\t\t<span class=\"post-category text-light\">  ${ blog.category } </span>\n\t\t\t\t\t\t\t\t\t<span class=\"post-date text-muted\"> ${ifUpdatedDate} </span>\t\n\t\t\t\t\t\t\t    </div>\n\n\t\t\t\t\t\t\t  <h5 class=\"card-title\"> ${ blog.title }</h5> \n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\n\t\t\t\t</a>`\n\t\t\t\n\t\t\tparrent.append(blogPreview);\n\t\t\t}\n\t\t});\n\t}\n\t\n\t\n\t//SEND REQUEST\n\n\tfunction getBlogs(startFrom = 0, quantity = 5, category = \"All\"){\n\n\t\treturn fetch(`/articles/get/${ startFrom }/${ category }/${ quantity }`)\n\t\t.then(respond => respond.json())\n\t\t.then(res => res)\n\t\t.catch(err => console.log(\"Failed to fetch\" + err))\t\n\t}\n\t\n\t\n\t\n\t\n\t// ========= RENDER STYCKY ADVERT BLOCK======================\n\tfunction renderStickyBlock(){\n\tconst advert = document.createElement(\"div\");\n\t\n\tadvert.innerHTML = `\n \n\n`\n\tadvert.style.cssText =`\n    height: 600px;\n    width: 300px;;\n     background: #ffc10750;\n    margin-bottom: 50px;\n`;\n\t\n\trightBarStickyBlock.append(advert);\n\trightBarStickyBlock.style.position = \"sticky\";\n\trightBarStickyBlock.style.top = \"20px\";\n\t}\n\t\n\n\t\n\t\n\t\n\t\n\t// Render up to 5 similar content links\n\t\n\tconst linkList = document.querySelector(\"#similar-articles\");\n\t\n\t\n\tgetBlogs(startFrom = 0, quantity = 20, \"All\")\n\t.then(data => renderSimilarContentLinks(data))\n\t\n\t\n\t\n\tasync function renderSimilarContentLinks (data){\n\t\tconst sameCategoryBlogs = await data.filter( blog => blog.category == category);\n\t\t\t\n\t    for(let i = 0; i < 5; i++){\n\t\t\t\n\t\t\tconst link = document.createElement(\"li\");\n\t\t\tlink.innerHTML = ` <a href=\"${sameCategoryBlogs[i].urlExtention}\" >${ sameCategoryBlogs[i].title} </a>`\n\t\t\t\n\t\t\tlinkList.append(link)\n\t\t}\n\t}\n\t\n\t\n\t\n});"],"sourceRoot":""}